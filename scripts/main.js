// Generated by Construct, the game and animation creation tool
// Visit: https://www.construct.net

"use strict";window.i=class{constructor(t,s){this.h=t,this.o=s,this.l=!1,this.u=()=>this.m()}v(){}_(t,s,i,e){this.h.S(this.o,t,s,i,e)}P(t,s,i,e){return this.h.M(this.o,t,s,i,e)}R(t,s,i){this.h.O()?this._(t,s,i):this.h.C()._OnMessageFromDOM({type:"event",component:this.o,handler:t,dispatchOpts:i||null,data:s,responseId:null})}T(t,s){this.h.I(this.o,t,s)}A(t){for(const[s,i]of t)this.T(s,i)}G(){return this.h}L(){return this.o}F(){this.l||(this.h.D(this.u),this.l=!0)}U(){this.l&&(this.h.W(this.u),this.l=!1)}m(){}},window.H=class{constructor(t,s){this.B=t,this.V=s,this.j=-1,this.N=-1/0,this.$=()=>this.Y(),this.X=!1,this.J=!1}K(t){this.J=!!t}Z(){if(-1!==this.j)return;const t=Date.now(),s=t-this.N,i=this.V;s>=i&&this.J?(this.N=t,this.tt()):this.j=self.setTimeout(this.$,Math.max(i-s,4))}tt(){this.X=!0,this.B(),this.X=!1}st(){this.X||(this.it(),this.N=Date.now())}Y(){this.j=-1,this.N=Date.now(),this.tt()}it(){-1!==this.j&&(self.clearTimeout(this.j),this.j=-1)}et(){this.it(),this.B=null,this.$=null}};{class t{constructor(t){this.ht=t,this.nt=!1,this.ot=!0,this.rt=-1,this.ct=-1,this.lt=-1}ut(t){this.ot=!!t}dt(){return this.ot}wt(){return this.nt}ft(){this.nt=!0}yt(){return this.rt}gt(t){this.rt=t}vt(){return this.ct}bt(t){this.ct=t}_t(t){this.lt=t}St(){return this.lt}kt(){return this.ht}}window.Pt=class extends self.i{constructor(t,s){super(t,s),this.Mt=new Map,this.Rt=!0,this.A([["create",t=>this.Ot(t)],["destroy",t=>this.xt(t)],["set-visible",t=>this.Ct(t)],["update-position",t=>this.Tt(t)],["update-state",t=>this.It(t)],["focus",t=>this.At(t)],["set-css-style",t=>this.Et(t)],["set-attribute",t=>this.Gt(t)],["remove-attribute",t=>this.Lt(t)]]),this.Ft("get-element",(t=>t))}Dt(t){this.Rt=!!t}Ft(t,s){this.T(t,(t=>{const i=t.elementId,e=this.Ut(i);return s(e,t)}))}Wt(t){for(const[s,i]of t)this.Ft(s,i)}Ot(s){const i=s.elementId,e=this.Ht(i,s),h=new t(e);this.Mt.set(i,h),e.style.boxSizing="border-box",e.style.display="none",h.ut(s.isVisible);const n=this.Bt(e);n.addEventListener("focus",(t=>this.Vt(i))),n.addEventListener("blur",(t=>this.jt(i)));const o=s.htmlIndex;if(h.gt(o),h._t(s.htmlZIndex),this.Rt){const t=this.G().Nt(o);h.bt(t),this.G().$t(t).appendChild(e)}}Ht(t,s){throw new Error("required override")}zt(t){}xt(t){const s=t.elementId,i=this.Ut(s);this.zt(i),this.Rt&&i.parentElement.removeChild(i),this.Mt.delete(s)}Yt(t,s,i){i||(i={}),i.elementId=s,this._(t,i)}qt(t,s,i){i||(i={}),i.elementId=s,this.R(t,i)}Ct(t){if(!this.Rt)return;const s=this.Mt.get(t.elementId),i=s.kt();s.wt()?i.style.display=t.isVisible?"":"none":s.ut(t.isVisible)}Tt(t){if(!this.Rt)return;const s=this.Mt.get(t.elementId),i=s.kt(),e=this.G();i.style.left=t.left+"px",i.style.top=t.top+"px",i.style.width=t.width+"px",i.style.height=t.height+"px";const h=t.fontSize;null!==h&&(i.style.fontSize=h+"em");const n=t.htmlIndex;s.gt(n);const o=e.Nt(n);o!==s.vt()&&(i.remove(),e.$t(o).appendChild(i),s.bt(o),e.Xt());const r=t.htmlZIndex;r!==s.St()&&(s._t(r),e.Xt()),s.wt()||(s.ft(),s.dt()&&(i.style.display=""))}Jt(){if(this.Rt)for(const t of this.Mt.values()){const s=this.G().Nt(t.yt()),i=t.vt();if(-1!==s&&-1!==i&&s!==i){const i=t.kt();i.remove(),this.G().$t(s).appendChild(i),t.bt(s)}}}Kt(){return this.Rt?[...this.Mt.values()]:null}It(t){const s=this.Ut(t.elementId);this.Zt(s,t)}Zt(t,s){throw new Error("required override")}Bt(t){return t}Vt(t){this.Yt("elem-focused",t)}jt(t){this.Yt("elem-blurred",t)}At(t){const s=this.Bt(this.Ut(t.elementId));t.focus?s.focus():s.blur()}Et(t){const s=this.Ut(t.elementId),i=t.prop,e=t.val;i.startsWith("--")?s.style.setProperty(i,e):s.style[i]=e}Gt(t){this.Ut(t.elementId).setAttribute(t.name,t.val)}Lt(t){this.Ut(t.elementId).removeAttribute(t.name)}Ut(t){const s=this.Mt.get(t);if(!s)throw new Error(`no element with id ${t}`);return s.kt()}}}{const s=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),i=/android/i.test(navigator.userAgent),e=/safari/i.test(navigator.userAgent)&&!/(chrome|chromium|edg\/|OPR\/|nwjs)/i.test(navigator.userAgent);let h=0;function n(t){const s=document.createElement("script");return s.async=!1,s.type="module",t.Qt?new Promise((i=>{const e="c3_resolve_"+h;++h,self[e]=i,s.textContent=t.ts+`\n\nself["${e}"]();`,document.head.appendChild(s)})):new Promise(((i,e)=>{s.onload=i,s.onerror=e,s.src=t,document.head.appendChild(s)}))}async function o(){if(!navigator.userActivation||"undefined"==typeof OffscreenCanvas)return!1;try{let t=!1;const s=new Blob(['\n\tself.addEventListener("message", () =>\n\t{\n\t\ttry {\n\t\t\tconst offscreenCanvas = new OffscreenCanvas(32, 32);\n\t\t\tconst gl = offscreenCanvas.getContext("webgl");\n\t\t\tself.postMessage(!!gl);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tconsole.warn("Feature detection worker error:", err);\n\t\t\tself.postMessage(false);\n\t\t}\n\t});'],{type:"text/javascript"}),i=new Worker(URL.createObjectURL(s),{get type(){t=!0}}),e=await new Promise((t=>{i.addEventListener("message",(s=>{i.terminate(),t(s.data)})),i.postMessage("")}));return t&&e}catch(t){return console.warn("Error feature detecting worker mode: ",t),!1}}let r=new Audio;const a={"audio/webm; codecs=opus":!!r.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!r.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!r.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!r.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!r.canPlayType("audio/mp4"),"audio/mpeg":!!r.canPlayType("audio/mpeg")};async function c(t){const s=await l(t);return new TextDecoder("utf-8").decode(s)}function l(t){return new Promise(((s,i)=>{const e=new FileReader;e.onload=t=>s(t.target.result),e.onerror=t=>i(t),e.readAsArrayBuffer(t)}))}r=null;const u=[];let d=0;const w=8;window.RealFile=window.File;const f=[],p=new Map,m=new Map;let y=0;const g=[];self.runOnStartup=function(t){if("function"!=typeof t)throw new Error("runOnStartup called without a function");g.push(t)};const v=new Set(["cordova","playable-ad-single-file","playable-ad-zip","instant-games"]);function b(t){return v.has(t)}let _=!1;window.ss=class t{constructor(t){if(this.es=t.hs,this.ns=null,this.rs="",this.cs=t.ls,this.us=null,this.ds=null,this.ws=[],this.fs=null,this.ps=!0,this.ys=[],this.gs=[],this.vs=!1,this.bs=()=>this._s(),this.Ss=!1,this.ks=0,this.Ps=null,this.Ms=-1,this.Rs=()=>this.Os(),this.xs=new Set,this.Cs=null,this.Ts=[],this.Is=t.As,this.Es="file"===location.protocol.substr(0,4),this.Gs=[],"playable-ad-single-file"!==this.Is&&"playable-ad-zip"!==this.Is&&"instant-games"!==this.Is||(this.es=!1),e&&(this.es=!1),"cordova"===this.Is&&this.es&&i){const t=/Chrome\/(\d+)/i.exec(navigator.userAgent);t&&parseInt(t[1],10)>=90||(this.es=!1)}this.Ls()?self.chrome.webview.addEventListener("message",(t=>this.Fs(t.data,t.additionalObjects))):"macos-wkwebview"===this.Is?self.C3WrapperOnMessage=t=>this.Fs(JSON.parse(t)):"linux-cef"===this.Is&&self.c3_linux_cef_set_message_callback((t=>this.Fs(JSON.parse(t)))),this.Ds=null,this.Us=null,"html5"!==this.Is||window.isSecureContext||console.warn("[Construct] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available."),this.I("canvas","update-size",(t=>this.Ws(t))),this.I("canvas","set-html-layer-count",(t=>this._OnSetHTMLLayerCount(t))),this.I("canvas","cleanup-html-layers",(()=>this.Hs())),this.I("canvas","update-html-layer-dom-state",(t=>this.Bs(t.layersDomState))),this.I("runtime","cordova-fetch-local-file",(t=>this.Vs(t))),this.I("runtime","create-job-worker",(t=>this.js(t))),this.I("runtime","send-wrapper-extension-message",(t=>this.Ns(t))),"cordova"===this.Is?document.addEventListener("deviceready",(()=>this.$s(t))):this.$s(t),this.zs=0}et(){this.Ys(),this.ns&&(this.ns.onmessage=null,this.ns=null),this.us&&(this.us.terminate(),this.us=null),this.ds&&(this.ds.et(),this.ds=null);for(const{canvas:t,qs:s}of this.ys)t.remove(),s.remove();this.ys.length=0}Xs(){return this.ys[0].canvas}Nt(t){return Math.min(t,this.ys.length-1)}$t(t){if(t<0||t>=this.ys.length)throw new RangeError("invalid canvas layer");return this.ys[t].qs}_GetHTMLWrapElement(t){return this.$t(t)}Js(){return this.rs}O(){return this.es}Ks(){return this.Is}Zs(){return this.Es}Qs(){return this.cs}ti(){return s&&"cordova"===this.Is}si(){const t=navigator.userAgent;return s&&b(this.Is)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(t)}ii(){return i}ei(){return i&&b(this.Is)}hi(){return"windows-webview2"===this.Is||!!("preview"===this.Is&&window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage)}Ls(){return this.hi()||"xbox-uwp-webview2"===this.Is}ni(){this.ei()&&this.zs++}oi(){return this.ri().next().value}*ri(){if(!this.ei())return!0;yield 0===this.zs,this.zs>0&&this.zs--}async $s(t){if(this.es&&(await o()||(this.es=!1)),"macos-wkwebview"===this.Is&&this.ai({type:"ready"}),this.Ls()||"macos-wkwebview"===this.Is||"linux-cef"===this.Is){this.ci();const t=await this.li();this.Ts=t.registeredComponentIds}if("playable-ad-single-file"===this.Is&&(this.Ds=self.c3_base64files,this.Us={},await this.di()),"nwjs"===this.Is&&self.nw&&(self.nw.Window.get().on("close",(()=>self.nw.App.quit())),self.nw.App.manifest["c3-steam-mode"])){let t=0;this.D((()=>{t++,document.documentElement.style.opacity=t%2==0?"1":"0.999"}))}if(t.wi)this.rs=t.wi;else{const t=location.origin;this.rs=("null"===t?"file:///":t)+location.pathname;const s=this.rs.lastIndexOf("/");-1!==s&&(this.rs=this.rs.substr(0,s+1))}const s=new MessageChannel;if(this.ns=s.port1,this.ns.onmessage=t=>this._OnMessageFromRuntime(t.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler((t=>this.fi(t))),this.Ps=new self.pi(this),await this.Ps.mi(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen)try{await new Promise(((t,s)=>{window.AndroidFullScreen.immersiveMode(t,s)}))}catch(t){console.error("Failed to enter Android immersive mode: ",t)}this.es?await this.yi(t,s.port2):await this.gi(t,s.port2)}bi(s){return{runtimeBaseUrl:this.rs,previewUrl:location.href,windowInnerWidth:this._i(),windowInnerHeight:this.Si(),cssDisplayMode:this.ki(),devicePixelRatio:window.devicePixelRatio,isFullscreen:t.Pi(),swClientId:window.cr_swClientId||"",exportType:s.As,isNWjs:"undefined"!=typeof nw,fileMap:globalThis.Mi??new Map(Object.entries(this.Ds??{})),scriptFolder:this.cs,isDebug:new URLSearchParams(self.location.search).has("debug"),ife:!!self.Ri,jobScheduler:this.Ps.Oi(),supportedAudioFormats:a,isFileProtocol:this.Es,isiOSCordova:this.ti(),isiOSWebView:this.si(),isWindowsWebView2:this.hi(),isAnyWebView2Wrapper:this.Ls(),wrapperComponentIds:this.Ts,isFBInstantAvailable:void 0!==self.FBInstant}}async yi(t,s){const i=t.xi;"preview"===this.Is?(this.us=new Worker("previewworker.js",{type:"module",name:"Runtime"}),await new Promise(((t,s)=>{const e=i=>{this.us.removeEventListener("message",e),i.data&&"ok"===i.data.type?t():s()};this.us.addEventListener("message",e),this.us.postMessage({type:"construct-worker-init",import:new URL(i,this.rs).toString()})}))):this.us=await this.Ci(i,{type:"module",name:"Runtime"});const e=document.createElement("canvas");e.style.display="none";const h=e.transferControlToOffscreen();document.body.appendChild(e);const n=document.createElement("div");n.className="c3htmlwrap",n.setAttribute("interactive",""),document.body.appendChild(n),this.ys.push({canvas:e,qs:n,Ti:{isVisible:!0,opacity:1,Ii:!0}}),window.c3canvas=e,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.us.postMessage(Object.assign(this.bi(t),{type:"init-runtime",isInWorker:!0,messagePort:s,canvas:h,runtimeScriptList:t.Ai,projectMainScriptPath:t.Ei,scriptsInEventsPath:t.Gi}),[s,h,...this.Ps.Li()]),this.ws=f.map((t=>new t(this))),this.Fi(),this.fs.Di(e),this.fs.Ui(n),this.fs.Wi(),self.c3_callFunction=(t,s)=>this.fs.Hi(t,s),"preview"===this.Is&&(self.goToLastErrorScript=()=>this.S("runtime","go-to-last-error-script"))}async gi(t,s){const i=document.createElement("canvas");i.style.display="none",document.body.appendChild(i);const e=document.createElement("div");e.className="c3htmlwrap",e.setAttribute("interactive",""),document.body.appendChild(e),this.ys.push({canvas:i,qs:e,Ti:{isVisible:!0,opacity:1,Ii:!0}}),window.c3canvas=i,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.ws=f.map((t=>new t(this))),this.Fi(),this.fs.Di(i),this.fs.Ui(e);const h=await Promise.all(t.Ai.map((t=>this.Bi(t))));await Promise.all(h.map((t=>n(t))));const o=t.Ei,r=t.Gi;if(o)try{if(await n(o),"preview"===this.Is&&!globalThis.Vi)throw new Error("main script did not run to completion")}catch(t){this.ji(),console.error("Error loading project main script: ",t),alert(`Failed to load the project main script (${o}). Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the script. Press F12 and check the console for error details.`)}if(r)try{if(await n(r),"preview"===this.Is&&!globalThis.$i.Ni)throw new Error("scripts in events did not run to completion")}catch(t){this.ji(),console.error("Error loading scripts in events: ",t),alert("Failed to load scripts in events. Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the 'Imports for events' script. Press F12 and check the console for error details.")}const a=Object.assign(this.bi(t),{isInWorker:!1,messagePort:s,canvas:i,runOnStartupFunctions:g});this.fs.Wi(),this.zi(),this.ds=self.C3_CreateRuntime(a),await self.C3_InitRuntime(this.ds,a)}async Ci(t,s){if(t.startsWith("blob:"))return new Worker(t,s);if("cordova"===this.Is&&this.Es){const i=await this.Yi(t),e=new Blob([i],{type:"application/javascript"});return new Worker(URL.createObjectURL(e),s)}if("playable-ad-single-file"===this.Is){const i=this.Ds[t];if(!i)throw new Error("missing script: "+t);return new Worker(URL.createObjectURL(i),s)}const i=new URL(t,location.href);if(location.origin!==i.origin){const t=await fetch(i);if(!t.ok)throw new Error("failed to fetch worker script");const e=await t.blob();return new Worker(URL.createObjectURL(e),s)}return new Worker(i,s)}_i(){return Math.max(window.innerWidth,1)}Si(){return Math.max(window.innerHeight,1)}ki(){if(this.Ls())return"standalone";const t=this.Ks();return new Set(["cordova","nwjs","macos-wkwebview","linux-cef"]).has(t)?"standalone":window.matchMedia("(display-mode: fullscreen)").matches?"fullscreen":window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: minimal-ui)").matches?"minimal-ui":navigator.standalone?"standalone":"browser"}zi(){this.ji()}ji(){const t=window.cr_previewLoadingElem;t&&(t.parentElement.removeChild(t),window.cr_previewLoadingElem=null)}async js(t){const s=await this.Ps.Xi();return{outputPort:s,transferables:[s]}}Ws(t){if(this.Ji())return;const s=t.styleWidth+"px",i=t.styleHeight+"px",e=t.marginLeft+"px",h=t.marginTop+"px";for(const{canvas:t,qs:n}of this.ys)t.style.width=s,t.style.height=i,t.style.marginLeft=e,t.style.marginTop=h,n.style.width=s,n.style.height=i,n.style.marginLeft=e,n.style.marginTop=h,this.ps&&(t.style.display="",n.style.display="");document.documentElement.style.setProperty("--construct-scale",t.displayScale),this.ps=!1}_OnSetHTMLLayerCount(t){const s=t.count,i=t.layersDomState,e=t.immediate,h=t.styleWidth+"px",n=t.styleHeight+"px",o=t.marginLeft+"px",r=t.marginTop+"px",a=[],c=[];if(s<this.ys.length)for(;this.ys.length>s;){const{canvas:t,qs:s}=this.ys.pop();s.remove(),this.es&&!e?this.gs.push(t):t.remove()}else if(s>this.ys.length)for(let t=0,i=s-this.ys.length;t<i;++t){const t=document.createElement("canvas");if(t.classList.add("c3overlay"),this.es){const s=t.transferControlToOffscreen();a.push(s),c.push(s)}else a.push(t);document.body.appendChild(t);const s=document.createElement("div");s.classList.add("c3htmlwrap","c3overlay"),s.setAttribute("interactive",""),document.body.appendChild(s),t.style.width=h,t.style.height=n,t.style.marginLeft=o,t.style.marginTop=r,s.style.width=h,s.style.height=n,s.style.marginLeft=o,s.style.marginTop=r,this.fs.Di(t),this.fs.Ui(s),this.ys.push({canvas:t,qs:s,Ti:{isVisible:!0,opacity:1,Ii:!0}})}this.Bs(i);for(const t of this.ws)t instanceof window.Pt&&t.Jt();return this.Xt(),{addedCanvases:a,transferables:c}}Bs(t){for(let s=0,i=Math.min(this.ys.length,t.length);s<i;++s){const{qs:i,Ti:e}=this.ys[s],h=t[s],n=h.isVisible,o=h.opacity,r=h.isInteractive;n!==e.isVisible&&(i.style.display=n?"":"none",e.isVisible=n),o!==e.opacity&&(i.style.opacity=1===o?"":String(o),e.opacity=o),r!==e.Ii&&(i.style.pointerEvents=r?"":"none",r?i.setAttribute("interactive",""):i.removeAttribute("interactive"),e.Ii=r)}}Hs(){for(const t of this.gs)t.remove();this.gs.length=0}Xt(){this.vs||(this.vs=!0,this.D(this.bs))}_s(){this.W(this.bs),this.vs=!1;let t=[];for(const s of this.ws)if(s instanceof window.Pt){const i=s.Kt();i&&t.push(...i)}t.sort(((t,s)=>{const i=t.vt(),e=s.vt();return i!==e?i-e:t.St()-s.St()}));let s=0,i=0,e=0,h=t.length;for(;e<h;++e){const h=t[e];h.vt()!==s&&(this.Ki(s,t.slice(i,e)),s=h.vt(),i=e)}i<e&&this.Ki(s,t.slice(i,e))}Ki(t,s){if(s.length<=1)return;if(t>=this.ys.length)return;const i=s.map((t=>t.kt())),e=new Set(i),h=this.$t(t),n=Array.from(h.children).filter((t=>e.has(t)));for(let t=0,s=0,e=i.length;t<e;++t){const e=i[t],o=n[s];e===o?++s:h.moveBefore?h.moveBefore(e,o):h.insertBefore(e,o)}}C(){if(this.es)throw new Error("not available in worker mode");return this.ds}S(t,s,i,e,h){this.ns.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:null},h)}M(t,s,i,e,h){const n=y++,o=new Promise(((t,s)=>{m.set(n,{resolve:t,reject:s})}));return this.ns.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:n},h),o}_OnMessageFromRuntime(t){const s=t.type;if("event"===s)return this.Zi(t);if("result"===s)this.Qi(t);else if("runtime-ready"===s)this.te();else if("alert-error"===s)this.ji(),alert(t.message);else{if("creating-runtime"!==s)throw new Error(`unknown message '${s}'`);this.zi()}}Zi(t){const s=t.component,i=t.handler,e=t.data,h=t.responseId,n=p.get(s);if(!n)return void console.warn(`[DOM] No event handlers for component '${s}'`);const o=n.get(i);if(!o)return void console.warn(`[DOM] No handler '${i}' for component '${s}'`);let r=null;try{r=o(e)}catch(t){return console.error(`Exception in '${s}' handler '${i}':`,t),void(null!==h&&this.se(h,!1,""+t))}if(null===h)return r;r&&r.then?r.then((t=>this.se(h,!0,t))).catch((t=>{console.error(`Rejection from '${s}' handler '${i}':`,t),this.se(h,!1,""+t)})):this.se(h,!0,r)}se(t,s,i){let e;i&&i.transferables&&(e=i.transferables),this.ns.postMessage({type:"result",responseId:t,isOk:s,result:i},e)}Qi(t){const s=t.responseId,i=t.isOk,e=t.result,h=m.get(s);i?h.resolve(e):h.reject(e),m.delete(s)}I(t,s,i){let e=p.get(t);if(e||(e=new Map,p.set(t,e)),e.has(s))throw new Error(`[DOM] Component '${t}' already has handler '${s}'`);e.set(s,i)}static ie(t){if(f.includes(t))throw new Error("DOM handler already added");f.push(t)}Fi(){for(const t of this.ws)if("runtime"===t.L())return void(this.fs=t);throw new Error("cannot find runtime DOM handler")}fi(t){this.S("debugger","message",t)}te(){for(const t of this.ws)t.v()}static Pi(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||_)}static ee(t){_=!!t}async he(){return await this.M("runtime","get-remote-preview-status-info")}D(t){this.xs.add(t),this.ne()}W(t){this.xs.delete(t),0===this.xs.size&&this.Ys()}ne(){-1===this.Ms&&this.xs.size>0&&(this.Ms=requestAnimationFrame(this.Rs))}Ys(){-1!==this.Ms&&(cancelAnimationFrame(this.Ms),this.Ms=-1)}Os(){this.Ms=-1;for(const t of this.xs)t();this.ne()}oe(t){this.fs.oe(t)}re(t){this.fs.re(t)}ae(){this.fs.ae()}ce(t){this.fs.ce(t)}le(t){return!!a[t]}ue(t){this.Ss=!0,this.ks=t}Ji(){return this.Ss}de(){return this.ks}we(t){return/^(?:[a-z\-]+:)?\/\//.test(t)||"data:"===t.substr(0,5)||"blob:"===t.substr(0,5)}fe(t){return!this.we(t)}async Bi(t){if("cordova"===this.Is&&(t.startsWith("file:")||this.Es&&this.fe(t))){let s=t;s.startsWith(this.rs)&&(s=s.substr(this.rs.length));const i=await this.Yi(s),e=new Blob([i],{type:"application/javascript"});return URL.createObjectURL(e)}if("playable-ad-single-file"===this.Is){if(this.Us.hasOwnProperty(t))return{Qt:!0,ts:this.Us[t]};if(this.Ds.hasOwnProperty(t))return URL.createObjectURL(this.Ds[t]);throw new Error("missing script: "+t)}return t}async Vs(t){const s=t.filename;switch(t.as){case"text":return await this.pe(s);case"buffer":return await this.Yi(s);default:throw new Error("unsupported type")}}me(t){const s=window.cordova.file.applicationDirectory+"www/"+t;return new Promise(((t,i)=>{window.resolveLocalFileSystemURL(s,(s=>{s.file(t,i)}),i)}))}async pe(t){const s=await this.me(t);return await c(s)}ye(){if(!u.length)return;if(d>=w)return;d++;const t=u.shift();this.ge(t.filename,t.ve,t.be)}Yi(t){return new Promise(((s,i)=>{u.push({filename:t,ve:t=>{d--,this.ye(),s(t)},be:t=>{d--,this.ye(),i(t)}}),this.ye()}))}async ge(t,s,i){try{const i=await this.me(t);s(await l(i))}catch(t){i(t)}}_PlayableAdFetchBlob(t){if(this.Ds.hasOwnProperty(t))return this.Ds[t];throw new Error("missing file: "+t)}_e(){const t=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof t)throw new Error("Permission API is not loaded");return t}Se(t,s){const i=t[s];if("string"!=typeof i)throw new Error("Invalid permission name");return i}ke(t){const s=this._e();return new Promise(((i,e)=>s.checkPermission(this.Se(s,t),(t=>i(!!t.hasPermission)),e)))}Pe(t){const s=this._e();return new Promise(((i,e)=>s.requestPermission(this.Se(s,t),(t=>i(!!t.hasPermission)),e)))}async Me(t){if("cordova"!==this.Ks())return!0;if(this.ti())return!0;for(const s of t)if(!await this.ke(s)&&!1===await this.Pe(s))return!1;return!0}async Re(...t){if(!1===await this.Me(t))throw new Error("Permission not granted")}Fs(s,i){if("object"!=typeof s||!s)return void console.warn("Unknown wrapper message: ",s);const e=s.type;if("directory-handles"===e)this.Gs=i;else if("wrapper-init-response"===e)this.Cs(s),this.Cs=null;else if("fullscreen-change"===e)t.ee(s.isFullscreen),this.fs.Oe();else if("log-to-console"===e)switch(s.logType){case"error":console.error(s.message);break;case"warning":console.warn(s.message);break;default:console.log(s.message)}else"extension-message"===e?this.S("runtime","wrapper-extension-message",s):console.warn("Unknown wrapper message: ",s)}Ns(t){this.ai({type:"extension-message",componentId:t.componentId,messageId:t.messageId,params:t.params||[],asyncId:t.asyncId})}ai(t){this.Ls()?window.chrome.webview.postMessage(JSON.stringify(t)):"macos-wkwebview"===this.Is?window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(t)):"linux-cef"===this.Is&&window.c3_linux_cef_sendmessage(JSON.stringify(t))}ci(){window.moveTo=(t,s)=>{this.ai({type:"set-window-position",windowX:Math.ceil(t),windowY:Math.ceil(s)})},window.resizeTo=(t,s)=>{this.ai({type:"set-window-size",windowWidth:Math.ceil(t),windowHeight:Math.ceil(s)})}}li(){return new Promise((t=>{this.Cs=t,this.ai({type:"wrapper-init"})}))}xe(){return this.Gs}async di(){const t=[];for(const[s,i]of Object.entries(this.Ds))t.push(this.Ce(s,i));await Promise.all(t)}async Ce(t,s){if("object"==typeof s)this.Ds[t]=new Blob([s.str],{type:s.type}),this.Us[t]=s.str;else{let i=await this.Te(s);i||(i=this.Ie(s)),this.Ds[t]=i}}async Te(t){try{const s=await fetch(t);return await s.blob()}catch(t){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",t),null}}Ie(t){const s=this.Ae(t);return this.Ee(s.data,s.Ge)}Ae(t){const s=t.indexOf(",");if(s<0)throw new URIError("expected comma in data: uri");const i=t.substring(5,s),e=t.substring(s+1),h=i.split(";"),n=h[0]||"",o=h[1],r=h[2];let a;return a="base64"===o||"base64"===r?atob(e):decodeURIComponent(e),{Ge:n,data:a}}Ee(t,s){let i,e,h=t.length,n=h>>2,o=new Uint8Array(h),r=new Uint32Array(o.buffer,0,n);for(i=0,e=0;i<n;++i)r[i]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;let a=3&h;for(;a--;)o[e]=t.charCodeAt(e),++e;return new Blob([o],{type:s})}}}{const S=self.ss;function k(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||t.originalEvent&&t.originalEvent.sourceCapabilities&&t.originalEvent.sourceCapabilities.firesTouchEvents}const P=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),M={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},R={dispatchUserScriptEvent:!0},O={dispatchRuntimeEvent:!0};async function x(t){const s=URL.createObjectURL(t);try{return await(i=s,new Promise(((t,s)=>{const e=new Image;e.onload=()=>t(e),e.onerror=t=>s(t),e.src=i})))}finally{URL.revokeObjectURL(s)}var i}function C(t){do{if(t.parentNode&&t.hasAttribute("contenteditable"))return!0;t=t.parentNode}while(t);return!1}const T=new Set(["input","textarea","datalist","select"]),I=new Set(["canvas","body","html"]);function A(t){if(!t.target.tagName)return;const s=t.target.tagName.toLowerCase();I.has(s)&&t.preventDefault()}function E(t){t.target.tagName&&t.target.classList.contains("c3htmlwrap")&&t.preventDefault()}function G(t){(t.metaKey||t.ctrlKey)&&t.preventDefault()}self.C3_GetSvgImageSize=async function(t){const s=await x(t);if(s.width>0&&s.height>0)return[s.width,s.height];{s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.visibility="hidden",document.body.appendChild(s);const t=s.getBoundingClientRect();return document.body.removeChild(s),[t.width,t.height]}},self.C3_RasterSvgImageBlob=async function(t,s,i,e,h){const n=await x(t),o=document.createElement("canvas");return o.width=e,o.height=h,o.getContext("2d").drawImage(n,0,0,s,i),o};let L=!1;function F(){try{return window.parent&&window.parent.document.hasFocus()}catch(t){return!1}}document.addEventListener("pause",(()=>L=!0)),document.addEventListener("resume",(()=>L=!1));const D="runtime",U=class extends self.i{constructor(t){super(t,D),this.Le=!1,this.Fe=-1,this.De="any",this.Ue=!1,this.We=!1,this.He=!1,this.Be=document.createElement("div"),this.Be.className="c3-screen-reader-text",this.Be.setAttribute("aria-live","polite"),document.body.appendChild(this.Be),this.Ve=null,this.je=!1,this.Ne="",this.$e=-1,this.ze=!1,this.Ye=t._i(),this.qe=t.Si(),this.Xe=0,this.Je=0,t.I("runtime","invoke-download",(t=>this.Ke(t))),t.I("runtime","load-webfonts",(t=>this.Ze(t))),t.I("runtime","raster-svg-image",(t=>this.Qe(t))),t.I("runtime","get-svg-image-size",(t=>this.th(t))),t.I("runtime","set-target-orientation",(t=>this.sh(t))),t.I("runtime","register-sw",(()=>this.ih())),t.I("runtime","post-to-debugger",(t=>this.eh(t))),t.I("runtime","go-to-script",(t=>this.eh(t))),t.I("runtime","before-start-ticking",(()=>this.hh())),t.I("runtime","debug-highlight",(t=>this.nh(t))),t.I("runtime","enable-device-orientation",(()=>this.oh())),t.I("runtime","enable-device-motion",(()=>this.rh())),t.I("runtime","add-stylesheet",(t=>this.ah(t))),t.I("runtime","script-create-worker",(t=>this.uh(t))),t.I("runtime","alert",(t=>this.dh(t))),t.I("runtime","screen-reader-text",(t=>this.wh(t))),t.I("runtime","hide-cordova-splash",(()=>this.fh())),t.I("runtime","set-exporting-to-video",(t=>this.ph(t))),t.I("runtime","export-to-video-progress",(t=>this.mh(t))),t.I("runtime","exported-to-video",(t=>this.yh(t))),t.I("runtime","exported-to-image-sequence",(t=>this.gh(t)));const s=new Set(["input","textarea","datalist"]);if(window.addEventListener("contextmenu",(t=>{const i=t.target,e=i.tagName.toLowerCase();s.has(e)||C(i)||t.preventDefault()})),window.addEventListener("selectstart",A),window.addEventListener("gesturehold",A),window.addEventListener("touchstart",A,{passive:!1}),window.addEventListener("pointerdown",A,{passive:!1}),this.bh=0,window.addEventListener("mousedown",(t=>{1===t.button&&t.preventDefault()})),window.addEventListener("mousewheel",G,{passive:!1}),window.addEventListener("wheel",G,{passive:!1}),window.addEventListener("resize",(()=>this._h())),window.addEventListener("fullscreenchange",(()=>this.Oe())),window.addEventListener("webkitfullscreenchange",(()=>this.Oe())),window.addEventListener("mozfullscreenchange",(()=>this.Oe())),window.addEventListener("fullscreenerror",(t=>this.Sh(t))),window.addEventListener("webkitfullscreenerror",(t=>this.Sh(t))),window.addEventListener("mozfullscreenerror",(t=>this.Sh(t))),t.si()){let t=1/0;window.visualViewport.addEventListener("resize",(()=>{const s=window.visualViewport.height;s>t&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0),t=s})),document.documentElement.setAttribute("ioswebview","")}this.kh=new Set,this.Ph=new WeakSet,this.Mh=!1}Di(t){t.addEventListener("selectstart",A),t.addEventListener("gesturehold",A),t.addEventListener("pointerdown",A)}Ui(t){t.addEventListener("selectstart",E),t.addEventListener("gesturehold",E),t.addEventListener("touchstart",E)}hh(){return self.setTimeout((()=>{this.ze=!0}),1e3),"cordova"===this.h.Ks()?(document.addEventListener("pause",(()=>this.Rh(!0))),document.addEventListener("resume",(()=>this.Rh(!1)))):document.addEventListener("visibilitychange",(()=>this.Rh("hidden"===document.visibilityState))),this.He=!("hidden"!==document.visibilityState&&!L),{isSuspended:this.He}}v(){window.addEventListener("focus",(()=>this.Oh("window-focus"))),window.addEventListener("blur",(()=>{this.Oh("window-blur",{parentHasFocus:F()}),this.bh=0})),window.addEventListener("focusin",(t=>{var s;s=t.target,(T.has(s.tagName.toLowerCase())||C(s))&&this.Oh("keyboard-blur")})),window.addEventListener("keydown",(t=>this.xh("keydown",t))),window.addEventListener("keyup",(t=>this.xh("keyup",t))),window.addEventListener("mousedown",(t=>this.Ch("mousedown",t,R))),window.addEventListener("mousemove",(t=>this.Ch("mousemove",t,R))),window.addEventListener("mouseup",(t=>this.Ch("mouseup",t,R))),window.addEventListener("dblclick",(t=>this.Ch("dblclick",t,M))),window.addEventListener("wheel",(t=>this.Th("wheel",t,M))),window.addEventListener("pointerdown",(t=>{this.Ih(t),this.Ah("pointerdown",t)})),this.h.O()&&void 0!==window.onpointerrawupdate&&self===self.top?window.addEventListener("pointerrawupdate",(t=>this.Eh(t))):window.addEventListener("pointermove",(t=>this.Ah("pointermove",t))),window.addEventListener("pointerup",(t=>this.Ah("pointerup",t))),window.addEventListener("pointercancel",(t=>this.Ah("pointercancel",t)));const t=()=>this.ae();window.addEventListener("pointerup",t,!0),window.addEventListener("touchend",t,!0),window.addEventListener("click",t,!0),window.addEventListener("keydown",t,!0),window.addEventListener("gamepadconnected",t,!0),this.h.ii()&&!this.h.ei()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",(()=>{this.Gh(this.Si(),navigator.virtualKeyboard.boundingRect.height)}))),this.h.si()&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0)}Gh(t,s){if(document.body.style.position="",document.body.style.overflow="",document.body.style.transform="",this.Je=0,s>0){const i=document.activeElement;if(i){const e=i.getBoundingClientRect();let h=(e.top+e.bottom)/2-(t-s)/2;h>s&&(h=s),h<0&&(h=0),h>0&&(document.body.style.position="absolute",document.body.style.overflow="visible",document.body.style.transform=`translateY(${-h}px)`,this.Je=h)}}}Oh(t,s){this._(t,s||null,O)}_i(){return this.h._i()}Si(){return this.h.Si()}Wi(){this.Le=!0,this.Ye=this.h._i(),this.qe=this.h.Si()}_h(){if(this.je)return;if(!this.Le)return;const t=this._i(),s=this.Si();if(this.h.ei())if(this.ze){if(this.h.oi()&&this.Ye===t&&s<this.qe)return this.Xe=this.qe-s,void this.Gh(this.qe,this.Xe);this.Xe>0&&(this.Xe=0,this.Gh(s,this.Xe)),this.Ye=t,this.qe=s}else this.Ye=t,this.qe=s;this._("window-resize",{innerWidth:t,innerHeight:s,devicePixelRatio:window.devicePixelRatio,isFullscreen:S.Pi(),cssDisplayMode:this.h.ki()}),this.h.si()&&(-1!==this.Fe&&clearTimeout(this.Fe),this.Lh(t,s,0))}Fh(t,s,i){-1!==this.Fe&&clearTimeout(this.Fe),this.Fe=setTimeout((()=>this.Lh(t,s,i)),48)}Lh(t,s,i){const e=this._i(),h=this.Si();this.Fe=-1,e!=t||h!=s?this._("window-resize",{innerWidth:e,innerHeight:h,devicePixelRatio:window.devicePixelRatio,isFullscreen:S.Pi(),cssDisplayMode:this.h.ki()}):i<10&&this.Fh(e,h,i+1)}sh(t){this.De=t.targetOrientation}Dh(){const t=this.De;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(t).catch((t=>console.warn("[Construct] Failed to lock orientation: ",t)));else try{let s=!1;screen.lockOrientation?s=screen.lockOrientation(t):screen.webkitLockOrientation?s=screen.webkitLockOrientation(t):screen.mozLockOrientation?s=screen.mozLockOrientation(t):screen.msLockOrientation&&(s=screen.msLockOrientation(t)),s||console.warn("[Construct] Failed to lock orientation")}catch(t){console.warn("[Construct] Failed to lock orientation: ",t)}}Oe(){if(this.je)return;const t=S.Pi();t&&"any"!==this.De&&this.Dh(),this._("fullscreenchange",{isFullscreen:t,innerWidth:this._i(),innerHeight:this.Si()})}Sh(t){console.warn("[Construct] Fullscreen request failed: ",t),this._("fullscreenerror",{isFullscreen:S.Pi(),innerWidth:this._i(),innerHeight:this.Si()})}Rh(t){if(this.He!==t&&(this.He=t,t?this.h.Ys():this.h.ne(),this._("visibilitychange",{hidden:t}),!t&&this.h.si())){const t=()=>{document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0};setTimeout(t,50),setTimeout(t,100),setTimeout(t,250),setTimeout(t,500)}}xh(t,s){if(void 0===s.key)return;if("Backspace"===s.key&&A(s),"nwjs"===this.h.Ks()&&"u"===s.key&&(s.ctrlKey||s.metaKey)&&s.preventDefault(),this.je)return;const i=P.get(s.code)||s.code;this.R(t,{code:i,key:s.key,which:s.which,repeat:s.repeat,altKey:s.altKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,shiftKey:s.shiftKey,timeStamp:s.timeStamp},M)}Th(t,s,i){this.je||this._(t,{clientX:s.clientX,clientY:s.clientY+this.Je,pageX:s.pageX,pageY:s.pageY+this.Je,deltaX:s.deltaX,deltaY:s.deltaY,deltaZ:s.deltaZ,deltaMode:s.deltaMode,timeStamp:s.timeStamp},i)}Ch(t,s,i){this.je||k(s)||this.R(t,{button:s.button,buttons:s.buttons,clientX:s.clientX,clientY:s.clientY+this.Je,pageX:s.pageX,pageY:s.pageY+this.Je,movementX:s.movementX||0,movementY:s.movementY||0,timeStamp:s.timeStamp},i)}Ah(t,s){if(this.je)return;let i=0;"mouse"===s.pointerType&&(i=this.bh),this.R(t,{pointerId:s.pointerId,pointerType:s.pointerType,button:s.button,buttons:s.buttons,lastButtons:i,clientX:s.clientX,clientY:s.clientY+this.Je,pageX:s.pageX,pageY:s.pageY+this.Je,movementX:s.movementX||0,movementY:s.movementY||0,width:s.width||0,height:s.height||0,pressure:s.pressure||0,tangentialPressure:s.tangentialPressure||0,tiltX:s.tiltX||0,tiltY:s.tiltY||0,twist:s.twist||0,timeStamp:s.timeStamp},M),"mouse"===s.pointerType&&(this.bh=s.buttons)}Eh(t){this.Ah("pointermove",t)}Uh(t,s){if(!this.je)for(let i=0,e=s.changedTouches.length;i<e;++i){const e=s.changedTouches[i];this.R(t,{pointerId:e.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:e.clientX,clientY:e.clientY+this.Je,pageX:e.pageX,pageY:e.pageY+this.Je,movementX:s.movementX||0,movementY:s.movementY||0,width:2*(e.radiusX||e.webkitRadiusX||0),height:2*(e.radiusY||e.webkitRadiusY||0),pressure:e.force||e.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:e.rotationAngle||0,timeStamp:s.timeStamp},M)}}Ih(t){window!==window.top&&window.focus(),this.Wh(t.target)&&document.activeElement&&!this.Wh(document.activeElement)&&document.activeElement.blur()}Wh(t){return!t||t===document||t===window||t===document.body||"canvas"===t.tagName.toLowerCase()}oh(){this.Ue||(this.Ue=!0,window.addEventListener("deviceorientation",(t=>this.Hh(t))),window.addEventListener("deviceorientationabsolute",(t=>this.Bh(t))))}rh(){this.We||(this.We=!0,window.addEventListener("devicemotion",(t=>this.Vh(t))))}Hh(t){this.je||this._("deviceorientation",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp,webkitCompassHeading:t.webkitCompassHeading,webkitCompassAccuracy:t.webkitCompassAccuracy},M)}Bh(t){this.je||this._("deviceorientationabsolute",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp},M)}Vh(t){if(this.je)return;let s=null;const i=t.acceleration;i&&(s={x:i.x||0,y:i.y||0,z:i.z||0});let e=null;const h=t.accelerationIncludingGravity;h&&(e={x:h.x||0,y:h.y||0,z:h.z||0});let n=null;const o=t.rotationRate;o&&(n={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this._("devicemotion",{acceleration:s,accelerationIncludingGravity:e,rotationRate:n,interval:t.interval,timeStamp:t.timeStamp},M)}Ke(t){const s=t.url,i=t.filename,e=document.createElement("a"),h=document.body;e.textContent=i,e.href=s,e.download=i,h.appendChild(e),e.click(),h.removeChild(e)}async Ze(t){const s=t.webfonts;await Promise.all(s.map((async t=>{const s=new FontFace(t.name,`url('${t.url}')`);document.fonts.add(s),await s.load()})))}async Qe(t){const s=t.blob,i=t.imageWidth,e=t.imageHeight,h=t.surfaceWidth,n=t.surfaceHeight,o=t.imageBitmapOpts,r=await self.C3_RasterSvgImageBlob(s,i,e,h,n);let a;return a=o?await createImageBitmap(r,o):await createImageBitmap(r),{imageBitmap:a,transferables:[a]}}async th(t){return await self.C3_GetSvgImageSize(t.blob)}async ah(t){var s;await(s=t.url,new Promise(((t,i)=>{const e=document.createElement("link");e.onload=()=>t(e),e.onerror=t=>i(t),e.rel="stylesheet",e.href=s,document.head.appendChild(e)})))}ae(){const t=[...this.kh];if(this.kh.clear(),!this.Mh)for(const s of t){const t=s.play();t&&t.catch((t=>{this.Ph.has(s)||this.kh.add(s)}))}}oe(t){if("function"!=typeof t.play)throw new Error("missing play function");let s;this.Ph.delete(t);try{s=t.play()}catch(s){return void this.kh.add(t)}s&&s.catch((s=>{this.Ph.has(t)||this.kh.add(t)}))}re(t){this.kh.delete(t),this.Ph.add(t)}ce(t){this.Mh=!!t}fh(){navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()}nh(t){if(!t.show)return void(this.Ve&&(this.Ve.style.display="none"));this.Ve||(this.Ve=document.createElement("div"),this.Ve.id="inspectOutline",document.body.appendChild(this.Ve));const s=this.Ve;s.style.display="",s.style.left=t.left-1+"px",s.style.top=t.top-1+"px",s.style.width=t.width+2+"px",s.style.height=t.height+2+"px",s.textContent=t.name}ih(){window.C3_RegisterSW&&window.C3_RegisterSW()}eh(t){window.c3_postToMessagePort&&(t.from="runtime",window.c3_postToMessagePort(t))}Hi(t,s){return this.P("js-invoke-function",{name:t,params:s})}uh(t){const s=t.url,i=t.opts,e=t.port2;new Worker(s,i).postMessage({type:"construct-worker-init",port2:e},[e])}dh(t){alert(t.message)}wh(t){const s=t.type;if("create"===s){const s=document.createElement("p");s.id="c3-sr-"+t.id,s.textContent=t.text,this.Be.appendChild(s)}else if("update"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.textContent=t.text:console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else if("release"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.remove():console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else console.warn(`[Construct] Unknown screen reader text update '${s}'`)}ph(t){this.je=!0;const s=document.createElement("h1");s.id="exportToVideoMessage",s.textContent=t.message,document.body.prepend(s),document.body.classList.add("exportingToVideo"),this.G().Xs().style.display="",this.h.ue(t.duration)}mh(t){this.Ne=t.message,-1===this.$e&&(this.$e=setTimeout((()=>this.jh()),250))}jh(){this.$e=-1;const t=document.getElementById("exportToVideoMessage");t&&(t.textContent=this.Ne)}yh(t){window.Nh({type:"exported-video",arrayBuffer:t.arrayBuffer,contentType:t.contentType,time:t.time})}gh(t){window.Nh({type:"exported-image-sequence",blobArr:t.blobArr,time:t.time,gif:t.gif})}};S.ie(U)}{const W="dispatchworker.js",H="jobworker.js";self.pi=class{constructor(t){this.$h=t,this.zh=Math.min(navigator.hardwareConcurrency||2,16),this.Yh=null,this.qh=[],this.Xh=null,this.Jh=null}async mi(){if(this.Kh)throw new Error("already initialised");this.Kh=!0;const t=this.$h.Qs()+W;this.Yh=await this.$h.Ci(t,{name:"DispatchWorker"});const s=new MessageChannel;this.Xh=s.port1,this.Yh.postMessage({type:"_init","in-port":s.port2},[s.port2]),this.Jh=await this.Xi()}async Xi(){const t=this.qh.length,s=this.$h.Qs()+H,i=await this.$h.Ci(s,{name:"JobWorker"+t}),e=new MessageChannel,h=new MessageChannel;return this.Yh.postMessage({type:"_addJobWorker",port:e.port1},[e.port1]),i.postMessage({type:"init",number:t,"dispatch-port":e.port2,"output-port":h.port2},[e.port2,h.port2]),this.qh.push(i),h.port1}Oi(){return{inputPort:this.Xh,outputPort:this.Jh,maxNumWorkers:this.zh}}Li(){return[this.Xh,this.Jh]}}}{const B="mouse",V=class extends self.i{constructor(t){super(t,B),this.A([["cursor",t=>this.Zh(t)],["request-pointer-lock",t=>this.Qh(t)],["release-pointer-lock",()=>this.tn()]]),document.addEventListener("pointerlockchange",(t=>this.sn())),document.addEventListener("pointerlockerror",(t=>this.en()))}Zh(t){document.documentElement.style.cursor=t}Qh(t){this.h.Xs().requestPointerLock(t)}tn(){document.exitPointerLock()}sn(){this._("pointer-lock-change",{"has-pointer-lock":!!document.pointerLockElement})}en(){this._("pointer-lock-error",{"has-pointer-lock":!!document.pointerLockElement})}};self.ss.ie(V)}{const j="keyboard",N=class extends self.i{constructor(t){super(t,j),this.hn=!(!navigator.keyboard||!navigator.keyboard.lock),this.A([["init",()=>this.nn()],["lock-keyboard",t=>this.rn(t)],["unlock-keyboard",()=>this.an()]])}nn(){return{isKeyboardLockSupported:this.hn}}async rn(t){const s=t.keysArr;try{return 0===s.length?await navigator.keyboard.lock():await navigator.keyboard.lock(s),{isOk:!0}}catch(t){return console.error("Error locking keyboard:",t),{isOk:!1}}}an(){try{navigator.keyboard.unlock()}catch(t){console.error("Error unlocking keyboard:",t)}}};self.ss.ie(N)}{const $="button";function z(t){t.stopPropagation()}const Y=class extends self.Pt{constructor(t){super(t,$)}Ht(t,s){const i=document.createElement("input"),e=s.isCheckbox;let h=i;if(e){i.type="checkbox";const t=document.createElement("label");t.appendChild(i),t.appendChild(document.createTextNode("")),t.style.fontFamily="sans-serif",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.display="inline-block",t.style.color="black",h=t}else i.type="button";return h.style.position="absolute",h.addEventListener("pointerdown",z),h.addEventListener("pointerrawupdate",z),h.addEventListener("pointerup",z),h.addEventListener("mousedown",z),h.addEventListener("mouseup",z),h.addEventListener("keydown",z),h.addEventListener("keyup",z),h.addEventListener("contextmenu",(t=>t.preventDefault())),i.addEventListener("click",(()=>this.qt("click",t,{isChecked:i.checked}))),s.id&&(i.id=s.id),s.className&&(i.className=s.className),this.Zt(h,s),h}cn(t){return"input"===t.tagName.toLowerCase()?t:t.firstChild}Bt(t){return this.cn(t)}Zt(t,s){const i=this.cn(t);i.checked=s.isChecked,i.disabled=!s.isEnabled,t.title=s.title,t===i?i.value=s.text:t.lastChild.textContent=s.text}};self.ss.ie(Y)}{const q=180/Math.PI,X="audio";self.ln=class extends self.i{constructor(t){super(t,X),this.un=null,this.dn=null,this.wn=!1,this.fn=!1,this.pn=()=>this.mn(),this.yn=[],this.gn=[],this.vn=null,this.bn=[],this._n=new Set,this.Sn=-1,this.kn=new Map,this.Pn=1,this.Mh=!1,this.Mn=0,this.Rn=1,this.On=0,this.xn="HRTF",this.Cn="inverse",this.Tn=600,this.In=1e4,this.An=1,this.En=[0,0,0],this.Gn=[0,0,-1,0,1,0],this.Ln=!1,this.Fn=null,this.Dn=new Map,this.Un=new Set,this.Wn=!1,this.Hn=!1,this.Bn="",this.Vn=null,self.C3Audio_OnMicrophoneStream=(t,s)=>this.jn(t,s),this.Nn=null,self.C3Audio_GetOutputStream=()=>this.$n(),self.C3Audio_DOMInterface=this,this.A([["create-audio-context",t=>this.zn(t)],["play",t=>this.Yn(t)],["stop",t=>this.qn(t)],["stop-all",()=>this.Xn()],["set-paused",t=>this.Jn(t)],["set-volume",t=>this.Kn(t)],["fade-volume",t=>this.Zn(t)],["set-master-volume",t=>this.Qn(t)],["set-muted",t=>this.so(t)],["set-silent",t=>this.io(t)],["set-looping",t=>this.eo(t)],["set-playback-rate",t=>this.ho(t)],["set-stereo-pan",t=>this.no(t)],["seek",t=>this.oo(t)],["preload",t=>this.ro(t)],["unload",t=>this.ao(t)],["unload-all",()=>this.co()],["set-suspended",t=>this.lo(t)],["add-effect",t=>this.uo(t)],["set-effect-param",t=>this.do(t)],["remove-effects",t=>this.wo(t)],["tick",t=>this.fo(t)],["load-state",t=>this.po(t)],["offline-render-audio",t=>this.mo(t)],["offline-render-finish",()=>this.yo()]])}async zn(t){if(t.usePlayMusicAsSoundWorkaround&&(this.Ln=!0),this.Mn=t.timeScaleMode,this.xn=["equalpower","HRTF","soundfield"][t.panningModel],this.Cn=["linear","inverse","exponential"][t.distanceModel],this.Tn=t.refDistance,this.In=t.maxDistance,this.An=t.rolloffFactor,this.h.Ji()){this.Ln=!0;const t=48e3;this.un=new OfflineAudioContext({numberOfChannels:2,sampleRate:t,length:Math.ceil(this.h.de()*t)})}else this.un=new AudioContext({latencyHint:t.latencyHint}),this.vo(),this.un.onstatechange=()=>{"running"!==this.un.state&&this.vo(),this._("audiocontext-state",{audioContextState:this.un.state})};this.dn=this.un.createGain(),this.dn.connect(this.un.destination);const s=t.listenerPos;this.En[0]=s[0],this.En[1]=s[1],this.En[2]=s[2],this.un.listener.setPosition(s[0],s[1],s[2]),this.un.listener.setOrientation(...this.Gn),self.C3_GetAudioContextCurrentTime=()=>this.bo();try{await Promise.all(t.preloadList.map((t=>this._o(t.originalUrl,t.url,t.type,!1))))}catch(t){console.error("[Construct] Preloading sounds failed: ",t)}return{sampleRate:this.un.sampleRate,audioContextState:this.un.state,outputLatency:this.un.outputLatency||0}}vo(){this.fn||(this.wn=!1,window.addEventListener("pointerup",this.pn,!0),window.addEventListener("touchend",this.pn,!0),window.addEventListener("click",this.pn,!0),window.addEventListener("keydown",this.pn,!0),this.fn=!0)}So(){this.fn&&(this.wn=!0,window.removeEventListener("pointerup",this.pn,!0),window.removeEventListener("touchend",this.pn,!0),window.removeEventListener("click",this.pn,!0),window.removeEventListener("keydown",this.pn,!0),this.fn=!1)}mn(){if(this.wn)return;const t=this.un;"suspended"===t.state&&t.resume&&t.resume();const s=t.createBuffer(1,220,22050),i=t.createBufferSource();i.buffer=s,i.connect(t.destination),i.start(0),"running"===t.state&&this.So()}ko(t,s){for(const i of s){let s=!1;for(const e of t)if(self.ln.Po(e,i)){s=!0;break}if(!s)return!1}return!0}Mo(){return this.un}bo(){return this.un.currentTime}Ro(){return this.dn}GetAudioContextExtern(){return this.Mo()}GetDestinationNodeExtern(){return this.Ro()}Oo(t){const s=this.Dn.get(t.toLowerCase());return s?s[0].xo():this.Ro()}Co(t,s){t=t.toLowerCase();let i=this.Dn.get(t);i||(i=[],this.Dn.set(t,i)),s.To(i.length),s.Io(t),i.push(s),this.Ao(t)}Ao(t){t=t.toLowerCase();let s=this.Ro();const i=this.Dn.get(t);if(i&&i.length){s=i[0].xo();for(let t=0,s=i.length;t<s;++t){const e=i[t];t+1===s?e.Eo(this.Ro()):e.Eo(i[t+1].xo())}}for(const i of this.Go(t))i.Lo(s);this.Vn&&this.Bn===t&&(this.Vn.disconnect(),this.Vn.connect(s))}Fo(){return this.Pn}Do(){return this.Mh}Uo(){return this.Mn}Wo(){return this.Rn}Ho(){return this.On}Bo(){return this.Ln}Vo(){return this.xn}jo(){return this.Cn}No(){return this.Tn}$o(){return this.In}zo(){return this.An}oe(t){this.h.oe(t)}re(t){this.h.re(t)}Yo(t){let s=0;for(let i=0,e=this.gn.length;i<e;++i){const e=this.gn[i];this.gn[s]=e,e.qo()===t?e.et():++s}this.gn.length=s}Xo(){let t=0;for(let s=0,i=this.yn.length;s<i;++s){const i=this.yn[s];this.yn[t]=i,i.Jo()&&i!==this.Fn?i.et():++t}this.yn.length=t}*Ko(t){if(t.length>0)for(const s of this.gn)this.ko(s.Zo(),t)&&(yield s);else this.vn&&!this.vn.Qo()&&(yield this.vn)}*Go(t){if(t)for(const s of this.gn)self.ln.Po(s.tr(),t)&&(yield s);else this.vn&&!this.vn.Qo()&&(yield this.vn)}async _o(t,s,i,e,h){for(const t of this.yn)if(t.sr()===s)return e&&this.Ln&&(this.Fn=t),await t.ir(),t;if(h)return null;e&&this.Ln&&this.Xo();const n=self.hr.er(this,t,s,i,e);return this.yn.push(n),e&&this.Ln&&(this.Fn=n),await n.ir(),this._n.has(t)||(this._("buffer-metadata",{originalUrl:t,duration:n.nr()}),this._n.add(t)),n}async rr(t,s,i,e,h){for(const t of this.gn)if(t.sr()===s&&(t.ar()||h))return h&&this.Ln&&(this.Fn=t.qo()),t.cr(e),t;const n=await this._o(t,s,i,h);if(n.lr())throw new Error(`buffer '${t}' unloaded while loading`);const o=n.ur(e);return this.gn.push(o),o}dr(t){const s=t.join(" ");let i=this.kn.get(s);if(!i){let t=null;i={wr:0,promise:new Promise((s=>t=s)),resolve:t},this.kn.set(s,i)}i.wr++}pr(t){const s=t.join(" "),i=this.kn.get(s);if(!i)throw new Error("expected pending tag");i.wr--,0===i.wr&&(i.resolve(),this.kn.delete(s))}mr(t){const s=(0===t.length?this.bn:t).join(" "),i=this.kn.get(s);return i?i.promise:Promise.resolve()}yr(){if(this.Un.size>0)this.F();else for(const t of this.gn)if(t.gr())return void this.F()}m(){for(const t of this.Un)t.m();const t=this.bo();for(const s of this.gn)s.m(t);const s=this.gn.filter((t=>t.gr())).map((t=>t.vr()));this._("state",{tickCount:this.Sn,outputLatency:this.un.outputLatency||0,audioInstances:s,analysers:[...this.Un].map((t=>t.br()))}),0===s.length&&0===this.Un.size&&this.U()}_r(t,s,i){this._("trigger",{type:t,tags:s,aiid:i})}async Yn(t){const s=t.originalUrl,i=t.url,e=t.type,h=t.isMusic,n=t.tags,o=t.isLooping,r=t.vol,a=t.pos,c=t.panning,l=t.stereoPan;let u=t.off;if(u>0&&!t.trueClock)if(this.un.getOutputTimestamp){const t=this.un.getOutputTimestamp();u=u-t.performanceTime/1e3+t.contextTime}else u=u-performance.now()/1e3+this.un.currentTime;this.bn=n.slice(0),this.dr(n);try{this.vn=await this.rr(s,i,e,n,h),c?(this.vn.Sr(!0),this.vn.kr(c.x,c.y,c.z,c.angle,c.innerAngle,c.outerAngle,c.outerGain),c.hasOwnProperty("uid")&&this.vn.Pr(c.uid)):"number"==typeof l&&0!==l?(this.vn.Mr(!0),this.vn.Rr(l)):(this.vn.Sr(!1),this.vn.Mr(!1)),this.vn.Play(o,r,a,u)}catch(t){return void console.error("[Construct] Audio: error starting playback: ",t)}finally{this.pr(n)}this.F()}qn(t){const s=t.tags;for(const t of this.Ko(s))t.Or()}Xn(){for(const t of this.gn)t.Or()}Jn(t){const s=t.tags,i=t.paused;for(const t of this.Ko(s))i?t.Cr():t.Tr();this.yr()}Kn(t){const s=t.tags,i=t.vol;for(const t of this.Ko(s))t.Ir(i)}no(t){const s=t.tags,i=t.p;for(const t of this.Ko(s))t.Mr(!0),t.Rr(i)}async Zn(t){const s=t.tags,i=t.vol,e=t.duration,h=t.stopOnEnd;await this.mr(s);for(const t of this.Ko(s))t.Ar(i,e,h);this.yr()}Qn(t){this.Pn=t.vol,this.dn.gain.value=this.Pn}so(t){const s=t.tags,i=t.isMuted;for(const t of this.Ko(s))t.Er(i)}io(t){this.Mh=t.isSilent,this.h.ce(this.Mh);for(const t of this.gn)t.Gr()}eo(t){const s=t.tags,i=t.isLooping;for(const t of this.Ko(s))t.Lr(i)}async ho(t){const s=t.tags,i=t.rate;await this.mr(s);for(const t of this.Ko(s))t.Fr(i)}async oo(t){const s=t.tags,i=t.pos;await this.mr(s);for(const t of this.Ko(s))t.Dr(i)}async ro(t){const s=t.originalUrl,i=t.url,e=t.type,h=t.isMusic;try{await this.rr(s,i,e,"",h)}catch(t){console.error("[Construct] Audio: error preloading: ",t)}}async ao(t){const s=t.url,i=t.type,e=t.isMusic,h=await this._o("",s,i,e,!0);if(!h)return;h.et(),this.Fn===h&&(this.Fn=null);const n=this.yn.indexOf(h);-1!==n&&this.yn.splice(n,1)}co(){for(const t of this.yn)t.et(),this.Fn===t&&(this.Fn=null);this.yn.length=0}lo(t){const s=t.isSuspended;!s&&this.un.resume&&this.un.resume();for(const t of this.gn)t.Ur(s);s&&this.un.suspend&&this.un.suspend()}fo(t){if(this.Rn=t.timeScale,this.On=t.gameTime,this.Sn=t.tickCount,0!==this.Mn)for(const t of this.gn)t.Wr();const s=t.listenerPos;!s||this.En[0]===s[0]&&this.En[1]===s[1]&&this.En[2]===s[2]||(this.En[0]=s[0],this.En[1]=s[1],this.En[2]=s[2],this.un.listener.setPosition(s[0],s[1],s[2]));const i=t.listenerOrientation;if(i&&(this.Gn[0]!==i[0]||this.Gn[1]!==i[1]||this.Gn[2]!==i[2]||this.Gn[3]!==i[3]||this.Gn[4]!==i[4]||this.Gn[5]!==i[5])){for(let t=0;t<6;++t)this.Gn[t]=i[t];this.un.listener.setOrientation(...this.Gn)}for(const s of t.instPans){const t=s.uid;for(const i of this.gn)i.Hr()===t&&i.Br(s.x,s.y,s.z,s.angle)}}async uo(t){const s=t.type,i=t.hasOwnProperty("tags")?t.tags:[t.tag],e=t.params;let h,n;if("convolution"===s)try{n=await this._o(t.bufferOriginalUrl,t.bufferUrl,t.bufferType,!1)}catch(t){return void console.log("[Construct] Audio: error loading convolution: ",t)}for(const o of i){if("filter"===s)h=new self.Vr(this,...e);else if("delay"===s)h=new self.jr(this,...e);else if("convolution"===s)h=new self.Nr(this,n.$r(),...e),h.zr(t.bufferOriginalUrl,t.bufferUrl,t.bufferType);else if("flanger"===s)h=new self.Yr(this,...e);else if("phaser"===s)h=new self.qr(this,...e);else if("gain"===s)h=new self.Xr(this,...e);else if("stereopan"===s)h=new self.Jr(this,...e);else if("tremolo"===s)h=new self.Kr(this,...e);else if("ringmod"===s)h=new self.Zr(this,...e);else if("distortion"===s)h=new self.Qr(this,...e);else if("compressor"===s)h=new self.ta(this,...e);else{if("analyser"!==s)throw new Error("invalid effect type");h=new self.sa(this,...e)}this.Co(o,h)}this.ia()}do(t){const s=t.tags,i=t.index,e=t.param,h=t.value,n=t.ramp,o=t.time;for(const t of s){const s=this.Dn.get(t.toLowerCase());!s||i<0||i>=s.length||s[i].ea(e,h,n,o)}this.ia()}wo(t){const s=t.tags;for(const t of s){const s=t.toLowerCase(),i=this.Dn.get(s);if(!i||!i.length)return;for(const t of i)t.et();this.Dn.delete(s),this.Ao(s)}}ha(t){this.Un.add(t),this.yr()}na(t){this.Un.delete(t)}ia(){this.Wn||(this.Wn=!0,Promise.resolve().then((()=>this.oa())))}oa(){const t={};for(const[s,i]of this.Dn)t[s]=i.map((t=>t.vr()));this._("fxstate",{fxstate:t}),this.Wn=!1}async po(t){const s=t.saveLoadMode;if(3!==s){const t=[];for(const i of this.gn)i.Jo()&&1===s||!i.Jo()&&2===s?t.push(i):i.et();this.gn=t}for(const t of this.Dn.values())for(const s of t)s.et();this.Dn.clear(),this.Rn=t.timeScale,this.On=t.gameTime;const i=t.listenerPos;this.En[0]=i[0],this.En[1]=i[1],this.En[2]=i[2],this.un.listener.setPosition(i[0],i[1],i[2]);const e=t.listenerOrientation;if(Array.isArray(e)){for(let t=0;t<6;++t)this.Gn[t]=e[t];this.un.listener.setOrientation(...this.Gn)}this.Mh=t.isSilent,this.h.ce(this.Mh),this.Pn=t.masterVolume,this.dn.gain.value=this.Pn;const h=[];for(const s of Object.values(t.effects))h.push(Promise.all(s.map((t=>this.uo(t)))));await Promise.all(h),await Promise.all(t.playing.map((t=>this.ra(t,s)))),this.yr()}async ra(t,s){if(3===s)return;const i=t.bufferOriginalUrl,e=t.bufferUrl,h=t.bufferType,n=t.isMusic,o=t.tags,r=t.isLooping,a=t.volume,c=t.playbackTime;if(n&&1===s)return;if(!n&&2===s)return;let l=null;try{l=await this.rr(i,e,h,o,n)}catch(t){return void console.error("[Construct] Audio: error loading audio state: ",t)}l.aa(t.pan),l.ca(t.stereoPan),l.Play(r,a,c,0),t.isPlaying||l.Cr(),l.la(t)}jn(t,s){this.Vn&&this.Vn.disconnect(),this.Bn=s.toLowerCase(),this.Vn=this.un.createMediaStreamSource(t),this.Vn.connect(this.Oo(this.Bn))}$n(){return this.Nn||(this.Nn=this.un.createMediaStreamDestination(),this.dn.connect(this.Nn)),this.Nn.stream}async mo(t){try{const s=t.time,i=this.un.suspend(s);this.Hn?this.un.resume():(this.un.startRendering().then((t=>this.ua(t))).catch((t=>this.da(t))),this.Hn=!0),await i}catch(t){this.da(t)}}yo(){this.un.resume()}ua(t){const s=[];for(let i=0,e=t.numberOfChannels;i<e;++i){const e=t.getChannelData(i);s.push(e.buffer)}this.h.S("runtime","offline-audio-render-completed",{duration:t.duration,length:t.length,numberOfChannels:t.numberOfChannels,sampleRate:t.sampleRate,channelData:s},null,s)}da(t){console.error("[Audio] Offline rendering error: ",t)}static Po(t,s){return t===s||t.normalize().toLowerCase()===s.normalize().toLowerCase()}static wa(t){return t*q}static fa(t){return Math.pow(10,t/20)}static pa(t){return Math.max(Math.min(self.ln.fa(t),1),0)}static ma(t){return Math.log(t)/Math.log(10)*20}static ya(t){return self.ln.ma(Math.max(Math.min(t,1),0))}static ga(t,s){return 1-Math.exp(-s*t)}},self.ss.ie(self.ln)}self.hr=class{constructor(t,s,i,e,h){this.va=t,this.ba=s,this._a=i,this.Sa=e,this.ka=h,this.Pa="",this.Ma="not-loaded",this.Ra=null}et(){this.Ma="not-loaded",this.va=null,this.Ra=null}lr(){return!this.va}static er(t,s,i,e,h){return!h||t.Bo()?new self.Oa(t,s,i,e,h):new self.xa(t,s,i,e,h)}ur(t){return"html5"===this.Pa?new self.Ca(this.va,this,t):new self.Ta(this.va,this,t)}Ia(){}ir(){return this.Ra||(this.Ra=this.Ia()),this.Ra}Aa(){}Ea(){}Ga(){return"failed"===this.Ma}Mo(){return this.va.Mo()}La(){return this.Pa}Fa(){return this.ba}sr(){return this._a}Da(){return this.Sa}Jo(){return this.ka}nr(){}},self.xa=class extends self.hr{constructor(t,s,i,e,h){super(t,s,i,e,h),this.Pa="html5",this.Ua=new Audio,this.Ua.crossOrigin="anonymous",this.Ua.autoplay=!1,this.Ua.preload="auto",this.Wa=null,this.Ha=null,this.Ba=!1,this.Ua.addEventListener("canplaythrough",(()=>this.Ba=!0)),this.Va=this.Mo().createGain(),this.ja=null,this.Ua.addEventListener("canplay",(()=>{this.Wa&&(this.Ma="loaded",this.Wa(),this.Wa=null,this.Ha=null),!this.ja&&this.Ua&&(this.ja=this.Mo().createMediaElementSource(this.Ua),this.ja.connect(this.Va))})),this.onended=null,this.Ua.addEventListener("ended",(()=>{this.onended&&this.onended()})),this.Ua.addEventListener("error",(t=>this.Na(t)))}et(){this.va.Yo(this),this.Va.disconnect(),this.Va=null,this.ja.disconnect(),this.ja=null,this.Ua&&!this.Ua.paused&&this.Ua.pause(),this.onended=null,this.Ua=null,super.et()}Ia(){return this.Ma="loading",new Promise(((t,s)=>{this.Wa=t,this.Ha=s,this.Ua.src=this._a}))}Na(t){console.error(`[Construct] Audio '${this._a}' error: `,t),this.Ha&&(this.Ma="failed",this.Ha(t),this.Wa=null,this.Ha=null)}Aa(){const t=this.Ua.readyState>=4;return t&&(this.Ba=!0),t||this.Ba}Ea(){return this.Aa()}$a(){return this.Ua}za(){return this.Va}nr(){return this.Ua.duration}},self.Oa=class extends self.hr{constructor(t,s,i,e,h){super(t,s,i,e,h),this.Pa="webaudio",this.Ya=null,this.qa=null}et(){this.va.Yo(this),this.Ya=null,this.qa=null,super.et()}async Xa(){if(this.Ya)return this.Ya;const t=this.va.G();if("cordova"===t.Ks()&&t.fe(this._a)&&t.Zs())this.Ya=await t.Yi(this._a);else if("playable-ad-single-file"===t.Ks()&&t.fe(this._a)){const s=t._PlayableAdFetchBlob(this._a);this.Ya=await s.arrayBuffer()}else{const t=await fetch(this._a);if(!t.ok)throw new Error(`error fetching audio data: ${t.status} ${t.statusText}`);this.Ya=await t.arrayBuffer()}}async Ja(){if(this.qa)return this.qa;const t=this.va.Mo();this.qa=await t.decodeAudioData(this.Ya),this.Ya=null}async Ia(){try{if(this.Ma="loading",await this.Xa(),this.lr())return;await this.Ja(),this.Ma="loaded"}catch(t){this.Ma="failed",console.error(`[Construct] Failed to load audio '${this._a}': `,t)}}Aa(){return!(!this.Ya&&!this.qa)}Ea(){return!!this.qa}$r(){return this.qa}nr(){return this.qa?this.qa.duration:0}};{let J=0;self.Ka=class{constructor(t,s,i){this.va=t,this.Za=s,this.Qa=i,this.tc=J++,this.sc=this.Mo().createGain(),this.sc.connect(this.Ro()),this.ec=null,this.hc=!1,this.nc=[0,0,0],this.oc=[0,0,0],this.rc=[0,0,0],this.ac=null,this.cc=!1,this.lc=0,this.uc=!0,this.dc=!1,this.wc=!1,this.fc=!1,this.mc=1,this.yc=!1,this.vc=1;const e=this.va.Uo();this.bc=1===e&&!this.Jo()||2===e,this._c=-1,this.Sc=-1,this.kc=!1}et(){this.va=null,this.Za=null,this.ec&&(this.ec.disconnect(),this.ec=null),this.ac&&(this.ac.disconnect(),this.ac=null),this.sc.disconnect(),this.sc=null}Mo(){return this.va.Mo()}cr(t){this.Qa=t}Zo(){return this.Qa}tr(){return this.Qa.length>0?this.Qa[0]:""}Ro(){return this.va.Oo(this.tr())}Pc(){return this.bc?this.va.Ho():performance.now()/1e3}Fa(){return this.Za.Fa()}sr(){return this.Za.sr()}Da(){return this.Za.Da()}qo(){return this.Za}Jo(){return this.Za.Jo()}Mc(){return this.tc}Qo(){}ar(){}IsPlaying(){return!this.uc&&!this.dc&&!this.Qo()}gr(){return!this.uc&&!this.Qo()}Rc(){}nr(t){let s=this.Za.nr();return t&&(s/=this.vc||.001),s}Play(t,s,i,e){}Or(){}Cr(){}Oc(){return this.dc}Tr(){}Ir(t){this.mc=t,this.sc.gain.cancelScheduledValues(0),this.Sc=-1,this.sc.gain.value=this.xc()}Ar(t,s,i){if(this.Cc())return;const e=this.sc.gain;e.cancelScheduledValues(0);const h=this.va.bo(),n=h+s;e.setValueAtTime(e.value,h),e.linearRampToValueAtTime(t,n),this.mc=t,this.Sc=n,this.kc=i}Tc(){this.Ir(this.mc)}m(t){-1!==this.Sc&&t>=this.Sc&&(this.Sc=-1,this.kc&&this.Or(),this.va._r("fade-ended",this.Qa,this.tc))}xc(){const t=this.mc;return isFinite(t)?t:0}Er(t){t=!!t,this.yc!==t&&(this.yc=t,this.Gr())}Cc(){return this.yc}Do(){return this.va.Do()}Gr(){}Lr(t){}Ic(){return this.fc}Fr(t){this.vc!==t&&(this.vc=t,this.Wr())}Wr(){}Ac(){return this.vc}Dr(t){}Ur(t){}Sr(t){t=!!t,this.hc!==t&&(this.hc=t,this.hc?(this.Mr(!1),this.ec||(this.ec=this.Mo().createPanner(),this.ec.panningModel=this.va.Vo(),this.ec.distanceModel=this.va.jo(),this.ec.refDistance=this.va.No(),this.ec.maxDistance=this.va.$o(),this.ec.rolloffFactor=this.va.zo()),this.sc.disconnect(),this.sc.connect(this.ec),this.ec.connect(this.Ro())):(this.ec.disconnect(),this.sc.disconnect(),this.sc.connect(this.Ro())))}kr(t,s,i,e,h,n,o){if(!this.hc)return;this.Br(t,s,i,e);const r=self.ln.wa;this.rc[0]!==r(h)&&(this.rc[0]=r(h),this.ec.coneInnerAngle=r(h)),this.rc[1]!==r(n)&&(this.rc[1]=r(n),this.ec.coneOuterAngle=r(n)),this.rc[2]!==o&&(this.rc[2]=o,this.ec.coneOuterGain=o)}Br(t,s,i,e){if(!this.hc)return;const h=this.nc,n=this.oc,o=Math.cos(e),r=Math.sin(e);h[0]===t&&h[1]===s&&h[2]===i||(h[0]=t,h[1]=s,h[2]=i,this.ec.setPosition(...h)),n[0]===o&&n[1]===r&&0===n[2]||(n[0]=o,n[1]=r,n[2]=0,this.ec.setOrientation(...n))}Mr(t){t=!!t,this.cc!==t&&(this.cc=t,this.cc?(this.Sr(!1),this.ac=this.Mo().createStereoPanner(),this.sc.disconnect(),this.sc.connect(this.ac),this.ac.connect(this.Ro())):(this.ac.disconnect(),this.ac=null,this.sc.disconnect(),this.sc.connect(this.Ro())))}Rr(t){this.cc&&this.lc!==t&&(this.ac.pan.value=t,this.lc=t)}Pr(t){this._c=t}Hr(){return this._c}Ec(){}Lo(t){const s=this.ac||this.ec||this.sc;s.disconnect(),s.connect(t)}vr(){return{aiid:this.Mc(),tags:this.Qa,duration:this.nr(),volume:-1===this.Sc?this.mc:this.sc.gain.value,isPlaying:this.IsPlaying(),playbackTime:this.Rc(),playbackRate:this.Ac(),uid:this._c,bufferOriginalUrl:this.Fa(),bufferUrl:"",bufferType:this.Da(),isMusic:this.Jo(),isLooping:this.Ic(),isMuted:this.Cc(),resumePosition:this.Ec(),pan:this.Gc(),stereoPan:this.Lc()}}la(t){this.Fr(t.playbackRate),this.Er(t.isMuted)}Gc(){if(!this.ec)return null;const t=this.ec;return{pos:this.nc,orient:this.oc,cia:t.coneInnerAngle,coa:t.coneOuterAngle,cog:t.coneOuterGain,uid:this._c}}aa(t){if(!t)return void this.Sr(!1);this.Sr(!0);const s=this.ec,i=t.pos;this.nc[0]=i[0],this.nc[1]=i[1],this.nc[2]=i[2];const e=t.orient;this.oc[0]=e[0],this.oc[1]=e[1],this.oc[2]=e[2],s.setPosition(...this.nc),s.setOrientation(...this.oc),this.rc[0]=t.cia,this.rc[1]=t.coa,this.rc[2]=t.cog,s.coneInnerAngle=t.cia,s.coneOuterAngle=t.coa,s.coneOuterGain=t.cog,this._c=t.uid}Lc(){return this.ac?this.lc:null}ca(t){"number"==typeof t?(this.Mr(!0),this.Rr(t)):this.Mr(!1)}}}self.Ca=class extends self.Ka{constructor(t,s,i){super(t,s,i),this.Za.za().connect(this.sc),this.Za.onended=()=>this.Fc()}et(){this.Or(),this.Za.za().disconnect(),super.et()}$a(){return this.Za.$a()}Fc(){this.uc=!0,this._c=-1,this.va._r("ended",this.Qa,this.tc)}Qo(){return this.$a().ended}ar(){return!!this.uc||this.Qo()}Rc(){let t=this.$a().currentTime;return this.fc||(t=Math.min(t,this.nr())),t}Play(t,s,i,e){const h=this.$a();if(1!==h.playbackRate&&(h.playbackRate=1),h.loop!==t&&(h.loop=t),this.Ir(s),this.yc=!1,h.muted&&(h.muted=!1),h.currentTime!==i)try{h.currentTime=i}catch(t){console.warn(`[Construct] Exception seeking audio '${this.Za.sr()}' to position '${i}': `,t)}this.va.oe(h),this.uc=!1,this.dc=!1,this.fc=t,this.vc=1}Or(){const t=this.$a();t.paused||t.pause(),this.va.re(t),this.uc=!0,this.dc=!1,this._c=-1}Cr(){if(this.dc||this.uc||this.Qo())return;const t=this.$a();t.paused||t.pause(),this.va.re(t),this.dc=!0}Tr(){!this.dc||this.uc||this.Qo()||(this.va.oe(this.$a()),this.dc=!1)}Gr(){this.$a().muted=this.yc||this.Do()}Lr(t){t=!!t,this.fc!==t&&(this.fc=t,this.$a().loop=t)}Wr(){let t=this.vc;this.bc&&(t*=this.va.Wo());try{this.$a().playbackRate=t}catch(s){console.warn(`[Construct] Unable to set playback rate '${t}':`,s)}}Dr(t){if(!this.uc&&!this.Qo())try{this.$a().currentTime=t}catch(s){console.warn(`[Construct] Error seeking audio to '${t}': `,s)}}Ec(){return this.Rc()}Ur(t){t?this.IsPlaying()?(this.$a().pause(),this.wc=!0):this.wc=!1:this.wc&&(this.va.oe(this.$a()),this.wc=!1)}},self.Ta=class extends self.Ka{constructor(t,s,i){super(t,s,i),this.Dc=null,this.Uc=t=>this.Fc(t),this.Wc=!0,this.Hc=null,this.Bc=0,this.Vc=0,this.jc=0,this.Nc=1}et(){this.Or(),this.$c(),this.Uc=null,super.et()}$c(){this.Dc&&(this.Dc.onended=null,this.Dc.disconnect(),this.Dc.buffer=null),this.Dc=null,this.Hc=null}Fc(t){this.dc||this.wc||t.target===this.Hc&&(this.Wc=!0,this.uc=!0,this._c=-1,this.$c(),this.va._r("ended",this.Qa,this.tc))}Qo(){return!(!this.uc&&this.Dc&&this.Dc.loop)&&!this.dc&&this.Wc}ar(){return!(this.Dc&&!this.uc)||this.Qo()}Rc(){let t=0;return t=this.dc?this.jc:this.Vc+(this.Pc()-this.Bc)*this.vc,this.fc||(t=Math.min(t,this.nr())),t}Play(t,s,i,e){this.yc=!1,this.Nc=1,this.Ir(s),this.$c(),this.Dc=this.Mo().createBufferSource(),this.Dc.buffer=this.Za.$r(),this.Dc.connect(this.sc),this.Hc=this.Dc,this.Dc.onended=this.Uc,this.Dc.loop=t,this.Dc.start(e,i),this.Wc=!1,this.uc=!1,this.dc=!1,this.fc=t,this.vc=1,this.Bc=this.Pc(),this.Vc=i}Or(){if(this.Dc)try{this.Dc.stop(0)}catch(t){}this.uc=!0,this.dc=!1,this._c=-1}Cr(){this.dc||this.uc||this.Qo()||(this.jc=this.Rc(),this.fc&&(this.jc%=this.nr()),this.dc=!0,this.Dc.stop(0))}Tr(){!this.dc||this.uc||this.Qo()||(this.$c(),this.Dc=this.Mo().createBufferSource(),this.Dc.buffer=this.Za.$r(),this.Dc.connect(this.sc),this.Hc=this.Dc,this.Dc.onended=this.Uc,this.Dc.loop=this.fc,this.Tc(),this.Wr(),this.Dc.start(0,this.jc),this.Bc=this.Pc(),this.Vc=this.jc,this.dc=!1)}xc(){return super.xc()*this.Nc}Gr(){this.Nc=this.yc||this.Do()?0:1,this.Tc()}Lr(t){t=!!t,this.fc!==t&&(this.fc=t,this.Dc&&(this.Dc.loop=t))}Wr(){let t=this.vc;this.bc&&(t*=this.va.Wo()),this.Dc&&(this.Dc.playbackRate.value=t)}Dr(t){this.uc||this.Qo()||(this.dc?this.jc=t:(this.Cr(),this.jc=t,this.Tr()))}Ec(){return this.jc}Ur(t){t?this.IsPlaying()?(this.wc=!0,this.jc=this.Rc(),this.fc&&(this.jc%=this.nr()),this.Dc.stop(0)):this.wc=!1:this.wc&&(this.$c(),this.Dc=this.Mo().createBufferSource(),this.Dc.buffer=this.Za.$r(),this.Dc.connect(this.sc),this.Hc=this.Dc,this.Dc.onended=this.Uc,this.Dc.loop=this.fc,this.Tc(),this.Wr(),this.Dc.start(0,this.jc),this.Bc=this.Pc(),this.Vc=this.jc,this.wc=!1)}la(t){super.la(t),this.jc=t.resumePosition}};{class K{constructor(t){this.va=t,this.un=t.Mo(),this.zc=-1,this.Yc="",this.Sa="",this.qc=null}et(){this.un=null}To(t){this.zc=t}Xc(){return this.zc}Io(t){this.Yc=t}Jc(){return this.Yc}Kc(){return this.un.createGain()}xo(){}Eo(t){}Zc(t,s,i,e){if(t.cancelScheduledValues(0),0===e)return void(t.value=s);const h=this.un.currentTime;switch(e+=h,i){case 0:t.setValueAtTime(s,e);break;case 1:t.setValueAtTime(t.value,h),t.linearRampToValueAtTime(s,e);break;case 2:t.setValueAtTime(t.value,h),t.exponentialRampToValueAtTime(s,e)}}vr(){return{type:this.Sa,tag:this.Yc,params:this.qc}}}self.Vr=class extends K{constructor(t,s,i,e,h,n,o){super(t),this.Sa="filter",this.qc=[s,i,e,h,n,o],this.Qc=this.Kc(),this.tl=this.Kc(),this.tl.gain.value=o,this.sl=this.Kc(),this.sl.gain.value=1-o,this.il=this.un.createBiquadFilter(),this.il.type=s,this.il.frequency.value=i,this.il.detune.value=e,this.il.Q.value=h,this.il.gain.vlaue=n,this.Qc.connect(this.il),this.Qc.connect(this.sl),this.il.connect(this.tl)}et(){this.Qc.disconnect(),this.il.disconnect(),this.tl.disconnect(),this.sl.disconnect(),super.et()}Eo(t){this.tl.disconnect(),this.tl.connect(t),this.sl.disconnect(),this.sl.connect(t)}xo(){return this.Qc}ea(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.qc[5]=s,this.Zc(this.tl.gain,s,i,e),this.Zc(this.sl.gain,1-s,i,e);break;case 1:this.qc[1]=s,this.Zc(this.il.frequency,s,i,e);break;case 2:this.qc[2]=s,this.Zc(this.il.detune,s,i,e);break;case 3:this.qc[3]=s,this.Zc(this.il.Q,s,i,e);break;case 4:this.qc[4]=s,this.Zc(this.il.gain,s,i,e)}}},self.jr=class extends K{constructor(t,s,i,e){super(t),this.Sa="delay",this.qc=[s,i,e],this.Qc=this.Kc(),this.tl=this.Kc(),this.tl.gain.value=e,this.sl=this.Kc(),this.sl.gain.value=1-e,this.el=this.Kc(),this.hl=this.un.createDelay(s),this.hl.delayTime.value=s,this.nl=this.Kc(),this.nl.gain.value=i,this.Qc.connect(this.el),this.Qc.connect(this.sl),this.el.connect(this.tl),this.el.connect(this.hl),this.hl.connect(this.nl),this.nl.connect(this.el)}et(){this.Qc.disconnect(),this.tl.disconnect(),this.sl.disconnect(),this.el.disconnect(),this.hl.disconnect(),this.nl.disconnect(),super.et()}Eo(t){this.tl.disconnect(),this.tl.connect(t),this.sl.disconnect(),this.sl.connect(t)}xo(){return this.Qc}ea(t,s,i,e){const h=self.ln.pa;switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.qc[2]=s,this.Zc(this.tl.gain,s,i,e),this.Zc(this.sl.gain,1-s,i,e);break;case 4:this.qc[1]=h(s),this.Zc(this.nl.gain,h(s),i,e);break;case 5:this.qc[0]=s,this.Zc(this.hl.delayTime,s,i,e)}}},self.Nr=class extends K{constructor(t,s,i,e){super(t),this.Sa="convolution",this.qc=[i,e],this.ol="",this.rl="",this.al="",this.Qc=this.Kc(),this.tl=this.Kc(),this.tl.gain.value=e,this.sl=this.Kc(),this.sl.gain.value=1-e,this.cl=this.un.createConvolver(),this.cl.normalize=i,this.cl.buffer=s,this.Qc.connect(this.cl),this.Qc.connect(this.sl),this.cl.connect(this.tl)}et(){this.Qc.disconnect(),this.cl.disconnect(),this.tl.disconnect(),this.sl.disconnect(),super.et()}Eo(t){this.tl.disconnect(),this.tl.connect(t),this.sl.disconnect(),this.sl.connect(t)}xo(){return this.Qc}ea(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.qc[1]=s,this.Zc(this.tl.gain,s,i,e),this.Zc(this.sl.gain,1-s,i,e))}zr(t,s,i){this.ol=t,this.rl=s,this.al=i}vr(){const t=super.vr();return t.bufferOriginalUrl=this.ol,t.bufferUrl="",t.bufferType=this.al,t}},self.Yr=class extends K{constructor(t,s,i,e,h,n){super(t),this.Sa="flanger",this.qc=[s,i,e,h,n],this.Qc=this.Kc(),this.sl=this.Kc(),this.sl.gain.value=1-n/2,this.tl=this.Kc(),this.tl.gain.value=n/2,this.ll=this.Kc(),this.ll.gain.value=h,this.hl=this.un.createDelay(s+i),this.hl.delayTime.value=s,this.ul=this.un.createOscillator(),this.ul.frequency.value=e,this.dl=this.Kc(),this.dl.gain.value=i,this.Qc.connect(this.hl),this.Qc.connect(this.sl),this.hl.connect(this.tl),this.hl.connect(this.ll),this.ll.connect(this.hl),this.ul.connect(this.dl),this.dl.connect(this.hl.delayTime),this.ul.start(0)}et(){this.ul.stop(0),this.Qc.disconnect(),this.hl.disconnect(),this.ul.disconnect(),this.dl.disconnect(),this.sl.disconnect(),this.tl.disconnect(),this.ll.disconnect(),super.et()}Eo(t){this.tl.disconnect(),this.tl.connect(t),this.sl.disconnect(),this.sl.connect(t)}xo(){return this.Qc}ea(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.qc[4]=s,this.Zc(this.tl.gain,s/2,i,e),this.Zc(this.sl.gain,1-s/2,i,e);break;case 6:this.qc[1]=s/1e3,this.Zc(this.dl.gain,s/1e3,i,e);break;case 7:this.qc[2]=s,this.Zc(this.ul.frequency,s,i,e);break;case 8:this.qc[3]=s/100,this.Zc(this.ll.gain,s/100,i,e)}}},self.qr=class extends K{constructor(t,s,i,e,h,n,o){super(t),this.Sa="phaser",this.qc=[s,i,e,h,n,o],this.Qc=this.Kc(),this.sl=this.Kc(),this.sl.gain.value=1-o/2,this.tl=this.Kc(),this.tl.gain.value=o/2,this.il=this.un.createBiquadFilter(),this.il.type="allpass",this.il.frequency.value=s,this.il.detune.value=i,this.il.Q.value=e,this.ul=this.un.createOscillator(),this.ul.frequency.value=n,this.dl=this.Kc(),this.dl.gain.value=h,this.Qc.connect(this.il),this.Qc.connect(this.sl),this.il.connect(this.tl),this.ul.connect(this.dl),this.dl.connect(this.il.frequency),this.ul.start(0)}et(){this.ul.stop(0),this.Qc.disconnect(),this.il.disconnect(),this.ul.disconnect(),this.dl.disconnect(),this.sl.disconnect(),this.tl.disconnect(),super.et()}Eo(t){this.tl.disconnect(),this.tl.connect(t),this.sl.disconnect(),this.sl.connect(t)}xo(){return this.Qc}ea(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.qc[5]=s,this.Zc(this.tl.gain,s/2,i,e),this.Zc(this.sl.gain,1-s/2,i,e);break;case 1:this.qc[0]=s,this.Zc(this.il.frequency,s,i,e);break;case 2:this.qc[1]=s,this.Zc(this.il.detune,s,i,e);break;case 3:this.qc[2]=s,this.Zc(this.il.Q,s,i,e);break;case 6:this.qc[3]=s,this.Zc(this.dl.gain,s,i,e);break;case 7:this.qc[4]=s,this.Zc(this.ul.frequency,s,i,e)}}},self.Xr=class extends K{constructor(t,s){super(t),this.Sa="gain",this.qc=[s],this.wl=this.Kc(),this.wl.gain.value=s}et(){this.wl.disconnect(),super.et()}Eo(t){this.wl.disconnect(),this.wl.connect(t)}xo(){return this.wl}ea(t,s,i,e){const h=self.ln.pa;4===t&&(this.qc[0]=h(s),this.Zc(this.wl.gain,h(s),i,e))}},self.Jr=class extends K{constructor(t,s){super(t),this.Sa="stereopan",this.qc=[s],this.wl=this.un.createStereoPanner(),this.wl.pan.value=s}et(){this.wl.disconnect(),super.et()}Eo(t){this.wl.disconnect(),this.wl.connect(t)}xo(){return this.wl}ea(t,s,i,e){s=Math.min(Math.max(s/100,-1),1),9===t&&(this.qc[0]=s,this.Zc(this.wl.pan,s,i,e))}},self.Kr=class extends K{constructor(t,s,i){super(t),this.Sa="tremolo",this.qc=[s,i],this.wl=this.Kc(),this.wl.gain.value=1-i/2,this.ul=this.un.createOscillator(),this.ul.frequency.value=s,this.dl=this.Kc(),this.dl.gain.value=i/2,this.ul.connect(this.dl),this.dl.connect(this.wl.gain),this.ul.start(0)}et(){this.ul.stop(0),this.ul.disconnect(),this.dl.disconnect(),this.wl.disconnect(),super.et()}Eo(t){this.wl.disconnect(),this.wl.connect(t)}xo(){return this.wl}ea(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.qc[1]=s,this.Zc(this.wl.gain,1-s/2,i,e),this.Zc(this.dl.gain,s/2,i,e);break;case 7:this.qc[0]=s,this.Zc(this.ul.frequency,s,i,e)}}},self.Zr=class extends K{constructor(t,s,i){super(t),this.Sa="ringmod",this.qc=[s,i],this.Qc=this.Kc(),this.tl=this.Kc(),this.tl.gain.value=i,this.sl=this.Kc(),this.sl.gain.value=1-i,this.fl=this.Kc(),this.fl.gain.value=0,this.ul=this.un.createOscillator(),this.ul.frequency.value=s,this.ul.connect(this.fl.gain),this.ul.start(0),this.Qc.connect(this.fl),this.Qc.connect(this.sl),this.fl.connect(this.tl)}et(){this.ul.stop(0),this.ul.disconnect(),this.fl.disconnect(),this.Qc.disconnect(),this.tl.disconnect(),this.sl.disconnect(),super.et()}Eo(t){this.tl.disconnect(),this.tl.connect(t),this.sl.disconnect(),this.sl.connect(t)}xo(){return this.Qc}ea(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.qc[1]=s,this.Zc(this.tl.gain,s,i,e),this.Zc(this.sl.gain,1-s,i,e);break;case 7:this.qc[0]=s,this.Zc(this.ul.frequency,s,i,e)}}},self.Qr=class extends K{constructor(t,s,i,e,h,n){super(t),this.Sa="distortion",this.qc=[s,i,e,h,n],this.Qc=this.Kc(),this.pl=this.Kc(),this.ml=this.Kc(),this.yl(e,h),this.tl=this.Kc(),this.tl.gain.value=n,this.sl=this.Kc(),this.sl.gain.value=1-n,this.gl=this.un.createWaveShaper(),this.vl=new Float32Array(65536),this.bl(s,i),this.gl.curve=this.vl,this.Qc.connect(this.pl),this.Qc.connect(this.sl),this.pl.connect(this.gl),this.gl.connect(this.ml),this.ml.connect(this.tl)}et(){this.Qc.disconnect(),this.pl.disconnect(),this.gl.disconnect(),this.ml.disconnect(),this.tl.disconnect(),this.sl.disconnect(),super.et()}yl(t,s){t<.01&&(t=.01),this.pl.gain.value=t,this.ml.gain.value=Math.pow(1/t,.6)*s}bl(t,s){const i=32768;for(let e=0;e<i;++e){let h=e/i;h=this._l(h,t,s),this.vl[i+e]=h,this.vl[i-e-1]=-h}}_l(t,s,i){const e=1.05*i*s-s,h=t<0?-1:1,n=t<0?-t:t;let o=n<s?n:s+e*self.ln.ga(n-s,1/e);return o*=h,o}Eo(t){this.tl.disconnect(),this.tl.connect(t),this.sl.disconnect(),this.sl.connect(t)}xo(){return this.Qc}ea(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.qc[4]=s,this.Zc(this.tl.gain,s,i,e),this.Zc(this.sl.gain,1-s,i,e))}},self.ta=class extends K{constructor(t,s,i,e,h,n){super(t),this.Sa="compressor",this.qc=[s,i,e,h,n],this.wl=this.un.createDynamicsCompressor(),this.wl.threshold.value=s,this.wl.knee.value=i,this.wl.ratio.value=e,this.wl.attack.value=h,this.wl.release.value=n}et(){this.wl.disconnect(),super.et()}Eo(t){this.wl.disconnect(),this.wl.connect(t)}xo(){return this.wl}ea(t,s,i,e){}},self.sa=class extends K{constructor(t,s,i){super(t),this.Sa="analyser",this.qc=[s,i],this.wl=this.un.createAnalyser(),this.wl.fftSize=s,this.wl.smoothingTimeConstant=i,this.Sl=new Float32Array(this.wl.frequencyBinCount),this.kl=new Uint8Array(s),this.Pl=0,this.Ml=0,this.va.ha(this)}et(){this.va.na(this),this.wl.disconnect(),super.et()}m(){this.wl.getFloatFrequencyData(this.Sl),this.wl.getByteTimeDomainData(this.kl);const t=this.wl.fftSize;this.Pl=0;let s=0;for(let i=0;i<t;++i){let t=(this.kl[i]-128)/128;t<0&&(t=-t),this.Pl<t&&(this.Pl=t),s+=t*t}const i=self.ln.ya;this.Pl=i(this.Pl),this.Ml=i(Math.sqrt(s/t))}Eo(t){this.wl.disconnect(),this.wl.connect(t)}xo(){return this.wl}ea(t,s,i,e){}br(){return{tag:this.Jc(),index:this.Xc(),peak:this.Pl,rms:this.Ml,binCount:this.wl.frequencyBinCount,freqBins:this.Sl}}}}if(window.C3_Is_Supported){const Z=!0;window.c3_runtimeInterface=new self.ss({hs:Z,xi:"workermain.js",Ai:["scripts/c3main.js"],ls:"scripts/",As:"html5"})}